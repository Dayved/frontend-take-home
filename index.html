<!DOCTYPE html>
<html>

<head>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>

  <title>Front End Take Home</title>
</head>

<body>
    <p>Please fill in the following information </p>
    <form>
        <label for="fname">Fullname:</label><br>
        <input type="text" id="fname" name = "fname"><br><br>
        <label for="email">Email:</label><br>
        <input type="text" id="email" name = "email"><br><br>
        <label for="password">Password:</label><br>
        <input type="password" id="password" name = "password"><br><br>
        <label for="occupation">Occupation:</label><br>
        <select name="occupation" id="occupation">
            <option value="empty">Select an occupation</option>
        </select> <br> <br>
        <label for="occupation">State:</label><br>
        <select name="state" id="State">
            <option value="empty">Select a state</option>
        </select>
    </form>
    <script>
        var job = document.getElementById('occupation');
        var states = document.getElementById('state');
        
        window.addEventListener("load", function () {
            httpGet("https://frontend-take-home.fetchrewards.com/form");
        });

        function httpGet(theUrl){
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", theUrl, false); // false for synchronous request
            xmlHttp.setRequestHeader("Content-Type", "application/json");
            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {
                    var json = JSON.parse(xmlHttp.responseText);
                    console.log(JSON.stringify(json, " ", 2));
                    var occ = json.occupations;
                    var st = json.states;
                    console.log(Object.values(st));
                    
                for (let value of Object.values(occ)){
                    var opt = document.createElement('option');
                    opt.text = value;
                    opt.value = value;
                    job.appendChild(opt);
                }

                for (let state of Object.values(st)){
                    var opt = document.createElement('option');
                    opt.text = state.abbreviation;
                    opt.value = state.abbreviation;
                    states.appendChild(opt);
                }
                    
                    
                }
            };
            xmlHttp.send();
        }
    </script>
</body>

</html>